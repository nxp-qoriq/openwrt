From 1b3fb37eedfde78e0bd61da01ea8002802714473 Mon Sep 17 00:00:00 2001
From: Pankit Garg <pankit.garg@nxp.com>
Date: Mon, 7 Sep 2020 17:06:42 +0530
Subject: [PATCH 4/9] db1046: dts: Make separate dts file for db1046

Make new dts file for db1046 board

Signed-off-by: Pankit Garg <pankit.garg@nxp.com>
---
 arch/arm/dts/Makefile           |  1 +
 arch/arm/dts/fsl-ls1046a-db.dts | 54 +++++++++++++++++++++++++++++++++
 configs/db1046_tfa_defconfig    |  2 +-
 3 files changed, 56 insertions(+), 1 deletion(-)
 create mode 100644 arch/arm/dts/fsl-ls1046a-db.dts

diff --git a/arch/arm/dts/Makefile b/arch/arm/dts/Makefile
index e4eadf6853..84a62492fe 100644
--- a/arch/arm/dts/Makefile
+++ b/arch/arm/dts/Makefile
@@ -355,6 +355,7 @@ dtb-$(CONFIG_FSL_LSCH2) += fsl-ls1043a-qds-duart.dtb \
 	fsl-ls1046a-qds-lpuart.dtb \
 	fsl-ls1046a-rdb.dtb \
 	fsl-ls1046a-frwy.dtb \
+	fsl-ls1046a-db.dtb \
 	fsl-ls1046a-wrdb.dtb \
 	fsl-ls1012a-qds.dtb \
 	fsl-ls1012a-rdb.dtb \
diff --git a/arch/arm/dts/fsl-ls1046a-db.dts b/arch/arm/dts/fsl-ls1046a-db.dts
new file mode 100644
index 0000000000..bc5dd1ccaf
--- /dev/null
+++ b/arch/arm/dts/fsl-ls1046a-db.dts
@@ -0,0 +1,54 @@
+// SPDX-License-Identifier: GPL-2.0+
+/*
+ * Device Tree Include file for Layerscape-1046AWRDB board.
+ *
+ * Copyright 2020 NXP
+ *
+ * Yuantian Tang <andy.tang@nxp.com>
+ */
+
+/dts-v1/;
+/include/ "fsl-ls1046a.dtsi"
+
+/ {
+	model = "LS1046A WRDB Board";
+
+	aliases {
+		spi0 = &qspi;
+	};
+
+};
+
+&qspi {
+	bus-num = <0>;
+	status = "okay";
+
+	qflash0: mt25qu512abb8esf@0 {
+		#address-cells = <1>;
+		#size-cells = <1>;
+		compatible = "spi-flash";
+		spi-max-frequency = <50000000>;
+		reg = <0>;
+	};
+
+	qflash1: mt25qu512abb8esf@1 {
+		#address-cells = <1>;
+		#size-cells = <1>;
+		compatible = "spi-flash";
+		spi-max-frequency = <50000000>;
+		reg = <1>;
+	};
+};
+
+&i2c0 {
+	status = "okay";
+
+	rtc@51 {
+		compatible = "pcf2127-rtc";
+		reg = <0x51>;
+	};
+};
+
+&i2c3 {
+	status = "okay";
+};
diff --git a/configs/db1046_tfa_defconfig b/configs/db1046_tfa_defconfig
index 8e8a2ca770..8064ea00b9 100644
--- a/configs/db1046_tfa_defconfig
+++ b/configs/db1046_tfa_defconfig
@@ -25,7 +25,7 @@ CONFIG_CMD_CACHE=y
 CONFIG_MP=y
 CONFIG_MTDPARTS_DEFAULT="mtdparts=1550000.spi-0:1m(rcw),15m(u-boot),48m(kernel.itb);7e800000.flash:16m(nand_uboot),48m(nand_kernel),448m(nand_free)"
 CONFIG_OF_CONTROL=y
-CONFIG_DEFAULT_DEVICE_TREE="fsl-ls1046a-wrdb"
+CONFIG_DEFAULT_DEVICE_TREE="fsl-ls1046a-db"
 CONFIG_ENV_IS_IN_MMC=y
 CONFIG_ENV_IS_IN_SPI_FLASH=y
 CONFIG_DM=y
-- 
2.17.1

